"use strict";function draw(a,b,c){var d=d3.scale.ordinal().range(["#51e566","#f9e75a","#f25170","#51aef3","#fc8c5a"]),e=a.data,f=Math.min(a.width,200),g=d3.select(b[0]).append("svg"),h=d3.layout.pie().sort(null);arc.outerRadius(f/2*.8).innerRadius(f/2*1),h.value(function(a){return+a.value}),g.attr({width:a.width,height:200});var i=g.append("g").attr("transform","translate("+a.width/2+",100)"),j=i.selectAll("path").data(h(e)).enter().append("path").attr("fill-opacity",1).attr("fill",function(a,b){return d(b)}).each(function(a){return this._current=a});a.$watch("data",function(b,c){j.data(h(a.data)),j.transition().duration(750).attrTween("d",arcTween)},!0)}function arcTween(a){var b=d3.interpolate(this._current,a);return this._current=b(0),function(a){return arc(b(a))}}var app=angular.module("app",["ngRoute","nvd3","ngMaterial","ngResource","angularModalService","ngMask"]).config(["$routeProvider","$locationProvider","$httpProvider","$sceDelegateProvider",function(a,b,c,d){a.when("/login",{templateUrl:"assets/templates/common/login.html",controller:"loginController"}).when("/asset/",{templateUrl:"../../assets/templates/assetManagment/assetDetail.html",controller:"assetDetailController"}).when("/dashboard/:dashboardSelect",{templateUrl:"../../assets/templates/common/dashboard.html",controller:"dashboardController"}).when("/dashboard/analytics",{templateUrl:"../../assets/templates/common/analyticsMapDashboard.html",controller:"analyticsMapController"}).otherwise({redirectTo:"/login"}),d.resourceUrlWhitelist(["**"])}]).factory("globalData",function(){var a={};return a.createMap=function(a,b){var c={};return angular.forEach(a,function(d,e){c[a[e][b]]=a[e]}),c},a}).service("PubSubService",function(){function a(a){var b={};a.constructor.prototype.publish=a.constructor.prototype.publish||function(){var a,c,d=this;a=[].slice.call(arguments),c=a.splice(0,1),angular.forEach(b[c]||[],function(b){b.handler.apply(d,a)})},a.constructor.prototype.subscribe=a.constructor.prototype.subscribe||function(a,c){var d=this,e=b[a]=b[a]||[];e.push({$id:d.$id,handler:c}),d.$on("$destroy",function(){for(var a=0,b=e.length;a<b;a++)if(e[a].$id===d.$id){e.splice(a,1);break}})}}return{Initialize:a}}).run(function(a,b,c,d,e){b.Initialize(a),a.$on("loginPageLoad",function(a){c.path("/login")}),e.ga("create","UA-99817080-1","auto"),e.ga("create","UA-99817080-1",{cookieDomain:"none"}),a.$on("$stateChangeSuccess",function(a){e.ga("send","pageview",c.path())})});app.controller("analyticsController",["$routeParams","$scope","$rootScope","$window","$location","locationMapService","getDataService","analyticsMapService",function(a,b,c,d,e,f,g,h){function i(a){function c(a){var b=0;if(document.getElementById("overallEffDiv")&&(b=document.getElementById("overallEffDiv").clientWidth),b>0){radialProgress(document.getElementById("overallEffDiv")).diameter(b).value(a).render()}}var e=0;h.getOverallEffData(a).then(function(a){e=a.data.overallEfficeincy,j=d3.select(document.getElementById("overallEffDiv")),c(e)}),h.getPerformanceData(a).then(function(a){b.performanceMetrics=a.data.performanceMetrics,b.filteredPerformanceMetrics=[],b.perfMetricChartData=[],b.totalPump=0,angular.forEach(b.performanceMetrics,function(a){b.totalPump=b.totalPump+a.units}),angular.forEach(b.performanceMetrics,function(a){var c={label:a.label,percentage:Number((a.units/b.totalPump*100).toFixed(1)),units:a.units};b.filteredPerformanceMetrics.push(c)}),angular.forEach(b.performanceMetrics,function(a){var c={label:a.label,value:a.units/b.totalPump*100};b.perfMetricChartData.push(c)}),b.callMetricDirective=!0}),angular.element(d).bind("resize",function(){document.getElementById("overallEffDiv")&&(document.getElementById("overallEffDiv").innerHTML=""),c(e),b.$digest()})}var j=d3.select(document.getElementById("overallEffDiv"));console.log("$rootScope.pumpType"+c.pumpType),c.activePage="analytics",b.performanceMetrics=[],b.totalPump=0,c.assetFilter="",b.callMetricDirective=!1,c.$on("callJSONservice",function(){i(c.pumpType)}),i(c.pumpType?c.pumpType:""),b.setStatusCircle=function(a){return"Performing Optimally"==a?"optimal_performance":"Failure Predicted"==a?"failure_predicted":"Failure"==a?"failure":"Undergoing Maintenance"==a?"maintenance":"No Data"==a?"no_data":void 0},b.redirectToAsset=function(a){"Performing Optimally"==a?c.assetFilter={machineStatus:"Performing_Optimally",pumpType:c.pumpType}:"Failure Predicted"==a?c.assetFilter={machineStatus:"Predicting_Failure",pumpType:c.pumpType}:"Failure"==a?c.assetFilter={machineStatus:"Failure",pumpType:c.pumpType}:"Undergoing Maintenance"==a?c.assetFilter={machineStatus:"Undergoing_Maintanence",pumpType:c.pumpType}:"No Data"==a&&(c.assetFilter={machineStatus:"NO_DATA",pumpType:c.pumpType}),location.replace("/#/dashboard/assetsearch")},b.setMetric=function(a){b.selectedLabel=a},b.selectedMetricCheck=function(a){return a==b.selectedLabel}}]),app.controller("analyticsMapController",["$routeParams","$scope","$rootScope","locationMapService","getDataService","analyticsMapService","$location",function(a,b,c,d,e,f,g){if(void 0==c.access_token)g.path("/login");else{b.selectedTab="analyticsView",c.activePage="analytics",c.showSpinner=!1,b.performanceMetrics=[],b.$watch("selection",function(a){c.pumpType=a,c.$emit("callJSONservice",{})}),b.selectTab=function(a){b.selectedTab=a},b.selectedTabCheck=function(a){if(a==b.selectedTab)return!0},f.getPumpTypeData().then(function(a){b.pumpTypeList=a.data.pumpType,b.selection="",c.pumpType=a.data.pumpType[0].value})}}]),app.controller("mapLocationController",["$routeParams","$scope","$rootScope","locationMapService","getDataService","$timeout","$interval","analyticsMapService",function(a,b,c,d,e,f,g,h){b.location=[],c.activePage="analytics",b.mapFilterList={PERFORMING_OPTIMALLY:!1,FAILURE:!1,PREDICTING_FAILURE:!1,MAINTENANCE:!1,NO_DATA:!1};!function(){h.getMapLocationData().then(function(a){b.location=a,d.createOutdoorMap(b.location)&&d.createMachineMarkers(b.location,b.mapFilterList)}),b.all=function(){b.mapFilterList.FAILURE=!1,b.mapFilterList.PREDICTING_FAILURE=!1,b.mapFilterList.UNDERGOING_MAINTENANCE=!1,b.mapFilterList.PERFORMING_OPTIMALLY=!1,b.mapFilterList.NO_DATA=!1,d.createMachineMarkers(b.location,b.mapFilterList)},b.performingOptimally=function(){b.mapFilterList.PERFORMING_OPTIMALLY=!b.mapFilterList.PERFORMING_OPTIMALLY,d.createMachineMarkers(b.location,b.mapFilterList)},b.failure=function(){b.mapFilterList.FAILURE=!b.mapFilterList.FAILURE,d.createMachineMarkers(b.location,b.mapFilterList)},b.failurePred=function(){b.mapFilterList.PREDICTING_FAILURE=!b.mapFilterList.PREDICTING_FAILURE,d.createMachineMarkers(b.location,b.mapFilterList)},b.underMaintainance=function(){b.mapFilterList.UNDERGOING_MAINTENANCE=!b.mapFilterList.UNDERGOING_MAINTENANCE,d.createMachineMarkers(b.location,b.mapFilterList)},b.noData=function(){b.mapFilterList.NO_DATA=!b.mapFilterList.NO_DATA,d.createMachineMarkers(b.location,b.mapFilterList)}}(),b.selectedFilterCheck=function(a){return b.selectedMapFilter==a}}]),app.controller("assetDetailController",["$routeParams","$scope","$rootScope","locationMapService","getDataService","$timeout","$interval","assetManagementService","globalData","ModalService","$location",function(a,b,c,d,e,f,g,h,i,j,k){function l(){h.getAssetInfoData(c.assetUri).then(function(a){b.assetInfo=a,i.assetInfo=b.assetInfo,t=b.assetInfo.analyticAttributes.machineEfficiencyLevel,n(t),b.assetLocation={lat:b.assetInfo.latitude,lon:b.assetInfo.longitude,status:b.assetInfo.analyticAttributes.machineStatus};var c,e,f;c=b.assetInfo.analyticAttributes.machineStatus,f=b.assetInfo.analyticAttributes.cavitation,"PREDICTING_FAILURE"==c?(e="#f9e75a",b.analyticsMachineStatusData="Predicting Failure"):"FAILURE"==c?(e="#f25170",b.analyticsMachineStatusData="Failure"):"UNDERGOING_MAINTENANCE"==c?(e="#51aef3",b.analyticsMachineStatusData="Undergoing Maintenance"):"PERFORMING_OPTIMALLY"==c?(e="#51e566",b.analyticsMachineStatusData="Performing Optimally"):(e="#fc8c5a",b.analyticsMachineStatusData="No Data"),m(e,parseInt(f));b.assetInfo.status;d.createOutdoorMap(b.assetLocation)&&d.createAssetMachineMarkers(b.assetLocation)})}function m(a,b){var c={chart:{type:"solidgauge"},title:null,pane:{center:["50%","85%"],size:"140%",startAngle:-90,endAngle:90,background:{backgroundColor:"#22262a",innerRadius:"88%",outerRadius:"100%",shape:"arc",borderColor:"#22262a"}},tooltip:{enabled:!1},yAxis:{stops:[[1,a]],lineWidth:0,minorTickInterval:null,tickAmount:0,title:{y:-16},labels:{y:"two"}},plotOptions:{solidgauge:{innerRadius:"88%",dataLabels:{y:5,borderWidth:0,useHTML:!0}}}};Highcharts.chart("container-speed",Highcharts.merge(c,{yAxis:{min:-100,max:798,title:{text:""}},credits:{enabled:!1},series:[{name:"Speed",data:[b],dataLabels:{format:'<div style="text-align:center"><span style="font-size:32px;color:#fff">{y}</span><br/><span style="font-size:16px;color:silver">PSI</span></div>'},tooltip:{valueSuffix:" psi"}}]}))}function n(a){radialProgress(document.getElementById("overallEffDiv")).diameter(200).value(a).render()}function o(a){Highcharts.stockChart("energyConsumption",{chart:{type:"line",zoomType:"y"},legend:{enabled:!0,align:"right",verticalAlign:"top",floating:!0,itemStyle:{color:"#f4f4f4"},itemHoverStyle:{color:"#FFF"}},rangeSelector:{enabled:!1},plotOptions:{series:{showInNavigator:!0}},navigator:{series:{type:"line",color:"#b9dc5b",lineColor:"#b9dc5b",smoothed:!1}},title:{text:""},xAxis:{type:"datetime"},yAxis:{opposite:!1,gridLineWidth:0,tickLength:5,tickWidth:1,tickPosition:"outside",labels:{align:"right",x:-10,y:5},lineWidth:1},credits:{enabled:!1},series:[{name:"Energy k/w",color:"#b9dc5b",data:a,tooltip:{valueDecimals:2},showInNavigator:!0}]})}function p(a){Highcharts.stockChart("vibration",{chart:{type:"line",zoomType:"y"},legend:{enabled:!0,align:"right",verticalAlign:"top",floating:!0,itemStyle:{color:"#f4f4f4"},itemHoverStyle:{color:"#FFF"}},rangeSelector:{enabled:!1},plotOptions:{series:{showInNavigator:!0}},navigator:{series:{type:"line",color:"#eaa156",lineColor:"#eaa156",smoothed:!1}},title:{text:""},xAxis:{type:"datetime"},yAxis:{opposite:!1,gridLineWidth:0,tickLength:5,tickWidth:1,tickPosition:"outside",labels:{align:"right",x:-10,y:5},lineWidth:1},credits:{enabled:!1},series:[{name:"Energy k/w",color:"#eaa156",data:a,tooltip:{valueDecimals:2},showInNavigator:!0}]})}function q(a){Highcharts.stockChart("daysToFailure",{chart:{type:"line",zoomType:"y"},legend:{enabled:!0,align:"right",verticalAlign:"top",floating:!0,itemStyle:{color:"#f4f4f4"},itemHoverStyle:{color:"#FFF"}},rangeSelector:{enabled:!1},plotOptions:{series:{showInNavigator:!0}},navigator:{series:{type:"line",color:"#f77163",lineColor:"#f77163",smoothed:!1}},title:{text:""},xAxis:{type:"datetime"},yAxis:{opposite:!1,gridLineWidth:0,tickLength:5,tickWidth:1,tickPosition:"outside",labels:{align:"right",x:-10,y:5},lineWidth:1},credits:{enabled:!1},series:[{name:"Energy k/w",color:"#f77163",data:a,tooltip:{valueDecimals:2},showInNavigator:!0}]})}function r(a,b){Highcharts.stockChart("dischargeAndSuction",{chart:{type:"line",zoomType:"y"},legend:{enabled:!0,align:"right",verticalAlign:"top",floating:!0,itemStyle:{color:"#f4f4f4"},itemHoverStyle:{color:"#FFF"}},rangeSelector:{enabled:!1},plotOptions:{series:{showInNavigator:!0}},navigator:{series:{type:"line",color:"#f77163",lineColor:"#f77163",smoothed:!1}},title:{text:""},xAxis:{type:"datetime"},yAxis:{opposite:!1,gridLineWidth:0,tickLength:5,tickWidth:1,tickPosition:"outside",labels:{align:"right",x:-10,y:5},lineWidth:1},credits:{enabled:!1},series:[{name:"Discharge (psi)",color:"#f77163",data:a,tooltip:{valueDecimals:2},showInNavigator:!0},{name:"Suction (psi)",color:"#eaa156",data:b,tooltip:{valueDecimals:2},showInNavigator:!0}]})}if(void 0==c.access_token)k.path("/login");else{c.activePage="assetManagement",c.assetUri||location.replace("/#/dashboard/assetsearch"),b.sensorData=[{sensorType:"Pressure 1",sensorStatus:"optimal_performance"},{sensorType:"Pressure 2",sensorStatus:"no_data"},{sensorType:"Electric Current",sensorStatus:"optimal_performance"},{sensorType:"Vibration",sensorStatus:"no_data"}],b.stepProgressData=[{date:"1 Feb",info:"4 Issue Fixed"},{date:"12 Feb",info:"24 Issue Fixed"},{date:"13 Feb",info:"1 Issue Fixed"},{date:"15 Feb",info:"1 Issue Fixed"},{date:"27 Feb",info:"2 Issue Fixed"}],b.hourData=[{label:"1 Day",value:"1d-ago"},{label:"1 Week",value:"1w-ago"},{label:"1 Month",value:"1m-ago"}],b.selectHour="1d-ago",b.$watch("selectHour",function(a){}),c.$on("refreshAssetDetail",function(a){console.log("redirection success"),l()}),b.executeTraining=function(){h.executeTraining().then(function(a){})},b.graphselect="false";var s="machine";b.$watch("graphselect",function(a){1==a?(h.getStoredDischargeGraphData().then(function(a){b.dischargeData=a["Discharge.pump11"],b.suctionData=a["Ingest.pump11"],r(b.dischargeData,b.suctionData)}),h.getStoredEnergyGraphData().then(function(a){b.energyConsumption=a["EnergyConsumption.pump11"],o(b.energyConsumption),p(b.energyConsumption),q(b.energyConsumption)}),s="stored"):(h.getPredixDischargeGraphData().then(function(a){b.dischargeData=a["Discharge.pump9"],b.suctionData=a["Ingest.pump9"],r(b.dischargeData,b.suctionData)}),h.getPredixEnergyGraphData().then(function(a){b.energyConsumption=a["EnergyConsumption.pump9"],o(b.energyConsumption),p(b.energyConsumption),q(b.energyConsumption)}),s="machine")});var t=0;h.getPredixDischargeGraphData().then(function(a){b.dischargeData=a["Discharge.pump9"],b.suctionData=a["Ingest.pump9"],r(b.dischargeData,b.suctionData)}),h.getPredixEnergyGraphData().then(function(a){b.energyConsumption=a["EnergyConsumption.pump9"],o(b.energyConsumption),p(b.energyConsumption),q(b.energyConsumption)}),l(),b.runAnalytics=function(){console.log("wer"+b.graphselect);var a={duration:b.selectHour,toggle:s};console.log("analyticFilterData"),console.log(a);var c,e,f;h.getAnalyticsData(a).then(function(a){b.assetInfoAnalytics=a,t=b.assetInfoAnalytics.analyticAttributes.machineEfficiencyLevel,n(t),b.assetLocation={lat:b.assetInfoAnalytics.latitude,lon:b.assetInfoAnalytics.longitude,status:b.assetInfoAnalytics.analyticAttributes.machineStatus};b.assetInfoAnalytics.status;d.createOutdoorMap(b.assetLocation)&&d.createAssetMachineMarkers(b.assetLocation),c=b.assetInfoAnalytics.analyticAttributes.machineStatus,f=b.assetInfoAnalytics.analyticAttributes.cavitation,b.assetInfo.analyticAttributes.machineStatus=b.assetInfoAnalytics.analyticAttributes.machineStatus}).then(function(a){"PREDICTING_FAILURE"==c?(e="#f9e75a",b.analyticsMachineStatusData="Predicting Failure"):"FAILURE"==c?(e="#f25170",b.analyticsMachineStatusData="Failure"):"UNDERGOING_MAINTENANCE"==c?(e="#51aef3",b.analyticsMachineStatusData="Undergoing Maintenance"):"PERFORMING_OPTIMALLY"==c?(e="#51e566",b.analyticsMachineStatusData="Performing Optimally"):(e="#fc8c5a",b.analyticsMachineStatusData="No Data");var d=parseInt(f);m(e,d)})},m("#fc8c5a",-100);o(),r(),p(),q(),b.editAssetDetail=function(){i.assetInfo=b.assetInfo,j.showModal({templateUrl:"assets/js/utils/editAssetInfoModal.html",controller:"ModalController"}).then(function(a){a.element.modal(),a.close.then(function(a){b.message="You said "+a})})}}}]),app.controller("assetManagementController",["$routeParams","$scope","$rootScope","assetManagementService","globalData","ModalService","$location",function(a,b,c,d,e,f,g){void 0==c.access_token?g.path("/login"):(c.activePage="assetManagement",b.currentPage=0,b.pageSize=10,b.numberOfPages,e.assetData="here is the new asset data",b.filteredAssetList=[],b.selectedManufacturerFilterList=[],b.selectedModelNameFilterList=[],b.activeManufacturerFilter=!0,b.activeModelNameFilter=!1,b.manufacturerList=[],b.modelNameList=[],b.useFilterList=!1,Array.prototype.removeValue=function(a,b){var c=$.map(this,function(c,d){return c[a]===b?null:c});this.length=0,this.push.apply(this,c)},Array.prototype.removeCustomValue=function(a,b,c,d){var e=$.map(this,function(e,f){return e[a]===b&&e[c]===d?null:e});this.length=0,this.push.apply(this,e)},Array.prototype.checkObjectInArray=function(a,b){if(!this||0===this.length)return!1;var c=!1;return angular.forEach(this,function(d){d[a]==b&&(c=!0)}),c},b.setStatusAsset=function(a){return"PERFORMING_OPTIMALLY"==a?"optimal_performance":"NO_DATA"==a?"no_data":"UNDERGOING_MAINTENANCE"==a?"maintenance":"PREDICTING_FAILURE"==a?"failure_predicted":"FAILURE"==a?"failure":void 0},b.setPage=function(a){b.currentPage=a<0?0:a},b.resetFilter=function(){b.filterActive=!1,b.activeManufacturerFilter=!1,b.activeModelNameFilter=!1,b.selectedManufacturerFilterList=[],b.selectedModelNameFilterList=[],b.filteredAssetList=c.assetsList},b.$watch(function(a){return a.assetsList},function(){b.resetFilter()}),b.toggleKeyFilter=function(a){"manufacturer"==a?(b.activeManufacturerFilter=!b.activeManufacturerFilter,b.activeModelNameFilter=!1,b.selectedManufacturerFilterList=b.activeManufacturerFilter?b.selectedManufacturerFilterList:[],b.filteredAssetList=b.activeManufacturerFilter?b.filteredAssetList:c.assetsList):"modelName"==a&&(b.activeModelNameFilter=!b.activeModelNameFilter,b.activeManufacturerFilter=!1,b.selectedModelNameFilterList=b.activeModelNameFilter?b.selectedModelNameFilterList:[],b.filteredAssetList=b.activeModelNameFilter?b.filteredAssetList:c.assetsList)},b.checkActiveFilterForValue=function(a,c){return!("manufacturer"!=a||!b.selectedManufacturerFilterList.checkObjectInArray(a,c))||!("modelName"!=a||!b.selectedModelNameFilterList.checkObjectInArray(a,c))},b.filterAssetList=function(a,d,e){0==b.selectedManufacturerFilterList.length&&0==b.selectedModelNameFilterList.length?("manufacturer"==a?angular.forEach(c.assetsList,function(c){c[a]==d&&b.selectedManufacturerFilterList.push(c)}):"modelName"==a&&angular.forEach(c.assetsList,function(c){c[a]==d&&b.selectedModelNameFilterList.push(c)}),b.filteredAssetList=[],angular.forEach(c.assetsList,function(c){c[a]==d&&b.filteredAssetList.push(c)})):"manufacturer"==a?b.selectedManufacturerFilterList.checkObjectInArray(a,d)?(angular.forEach(b.selectedManufacturerFilterList,function(c){c[a]==d&&(b.selectedModelNameFilterList.checkObjectInArray("modelName",c.modelName)||b.filteredAssetList.removeCustomValue(a,d,"modelName",c.modelName))}),b.selectedManufacturerFilterList.removeValue(a,d)):(angular.forEach(c.assetsList,function(c){c[a]==d&&b.selectedManufacturerFilterList.push(c)}),angular.forEach(c.assetsList,function(c){c[a]==d&&b.filteredAssetList.indexOf(c)<0&&b.filteredAssetList.push(c)})):"modelName"==a&&(b.selectedModelNameFilterList.checkObjectInArray(a,d)?(angular.forEach(b.selectedModelNameFilterList,function(c){c[a]==d&&(b.selectedModelNameFilterList.checkObjectInArray("manufacturer",c.manufacturer)||b.filteredAssetList.removeCustomValue(a,d,"manufacturer",c.manufacturer))}),b.selectedModelNameFilterList.removeValue(a,d)):(angular.forEach(c.assetsList,function(c){c[a]==d&&b.selectedModelNameFilterList.push(c)}),angular.forEach(c.assetsList,function(c){c[a]==d&&b.filteredAssetList.indexOf(c)<0&&b.filteredAssetList.push(c)}))),0==b.selectedManufacturerFilterList.length&&0==b.selectedModelNameFilterList.length&&(b.filteredAssetList=c.assetsList),b.numberOfPages=Math.ceil(b.filteredAssetList.length/b.pageSize)},b.prepareAssetsList=function(){b.filteredAssetList=[],c.assetsList||d.getAssetsList().then(function(a){c.assetsList=a}),c.assetFilter&&c.assetFilter.product&&""!=c.assetFilter.product?(b.useFilterList=!0,angular.forEach(c.assetsList,function(a){a.serialNumber==c.assetFilter.product&&b.filteredAssetList.push(a)})):c.assetFilter&&c.assetFilter.machineStatus&&""!=c.assetFilter.machineStatus&&!c.assetFilter.pumpType&&""==c.assetFilter.pumpType?(b.useFilterList=!0,angular.forEach(c.assetsList,function(a){a.analyticAttributes.machineStatus.toUpperCase()==c.assetFilter.machineStatus.toUpperCase()&&b.filteredAssetList.push(a)})):c.assetFilter&&c.assetFilter.machineStatus&&""!=c.assetFilter.machineStatus&&c.assetFilter.pumpType&&""!=c.assetFilter.pumpType?(b.useFilterList=!0,angular.forEach(c.assetsList,function(a){a.analyticAttributes.machineStatus.toUpperCase()==c.assetFilter.machineStatus.toUpperCase()&&a.pumpType.toUpperCase()==c.assetFilter.pumpType.toUpperCase()&&b.filteredAssetList.push(a)})):(b.useFilterList=!1,b.filteredAssetList=c.assetsList),(b.manufacturerList.length<=0||b.modelNameList.length<=0)&&angular.forEach(c.assetsList,function(a){var c=!1,d=!1;angular.forEach(b.manufacturerList,function(b){b.manufacturer===a.manufacturer&&(c=!0)}),angular.forEach(b.modelNameList,function(b){b.modelName===a.modelName&&(d=!0)}),c||b.manufacturerList.push(a),d||b.modelNameList.push(a)})},b.$watch(function(a){return a.filteredAssetList},function(){b.filteredAssetList&&(b.numberOfPages=Math.ceil(b.filteredAssetList.length/b.pageSize))}),b.$watch(function(a){return a.assetFilter},function(){c.assetFilter&&b.prepareAssetsList()}),b.prepareAssetsList(),b.createAssetDetail=function(){e.assetInfo=b.assetInfo,f.showModal({templateUrl:"assets/js/utils/createAssetInfoModal.html",controller:"createAssetModalController"}).then(function(a){a.element.modal(),a.close.then(function(a){b.message="You said "+a})})})}]),app.filter("startFrom",function(){return function(a,b){return b=+b,a.slice(b)}}),app.filter("range",function(){return function(a,b){b=parseInt(b);for(var c=0;c<b;c++)a.push(c);return a}}),app.controller("ModalController",["$scope","close","globalData","assetManagementService","$element","$rootScope",function(a,b,c,d,e,f){function g(a){for(var b=atob(a.split(",")[1]),c=a.split(",")[0].split(":")[1].split(";")[0],d=[],e=0;e<b.length;e++)d.push(b.charCodeAt(e));return new Blob([new Uint8Array(d)],{type:c})}console.log("this is the "),console.log(c.assetInfo),a.showAdvancedSec=!1,a.showAdvanced=function(){a.showAdvancedSec=!a.showAdvancedSec,document.getElementById("editAssetDetail").style.marginTop="-5px"},a.assetEditInfo=angular.copy(c.assetInfo),c.assetInfo="",a.uploadme="../assets/images/machine-1.png",a.uploadImage=function(){var b=new FormData,c=g(a.uploadme);b.append("file",c),$http.post("imageURL",b,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(a){console.log("success",a)}).error(function(a){console.log("error",a)})},a.removeImage=function(){a.uploadme="https://x1.xingassets.com/assets/frontend_minified/img/users/nobody_m.original.jpg"},a.saveData=function(){a.assetEditInfo.temperature=parseInt(a.assetEditInfo.temperature),d.updateAssetInfoData(a.assetEditInfo).then(function(a){a.data.result&&(f.$broadcast("refreshAssetDetail",!0),e.modal("hide"),console.log("here"),b("",500))})},a.closeModal=function(){e.modal("hide"),console.log("here"),b("",500)}}]),app.controller("createAssetModalController",["$scope","close","globalData","assetManagementService","$element","$rootScope",function(a,b,c,d,e,f){function g(a){for(var b=atob(a.split(",")[1]),c=a.split(",")[0].split(":")[1].split(";")[0],d=[],e=0;e<b.length;e++)d.push(b.charCodeAt(e));return new Blob([new Uint8Array(d)],{type:c})}a.assetEditInfo={uri:"",modelName:"",manufacturer:"",pumpType:"",serialNumber:"",machineHorsePower:"",latitude:"",longitude:"",image_url:"",Temperature:"",suctionPressureRequired:"",maxPowerConsumption:"",lastMaintenanceDate:"",manufacturedDate:"",capacity:"",tsIdentifier_ingest:"",tsIdentifier_discharge:"",tsIdentifier_energyConsumption:"",analyticAttributes:{averagePowerConsumption:"",machineEfficiencyLevel:"",machineStatus:"",cavitation:""}},a.uploadme="../assets/images/machine-1.png",a.uploadImage=function(){var b=new FormData,c=g(a.uploadme);b.append("file",c),$http.post("imageURL",b,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(a){console.log("success",a)}).error(function(a){console.log("error",a)})},a.removeImage=function(){a.uploadme="https://x1.xingassets.com/assets/frontend_minified/img/users/nobody_m.original.jpg"},a.machineId="",a.$watch("machineId",function(b){a.assetEditInfo.uri="/machine/"+b}),a.saveData=function(){console.log("$scope.assetEditInfo"),console.log(a.assetEditInfo),d.updateAssetInfoData(a.assetEditInfo).then(function(a){"Success"==a.data.result&&(f.$broadcast("refreshAssetSearch",!0),e.modal("hide"),console.log("here"),b("",500))})},a.closeModal=function(){e.modal("hide"),console.log("here"),b("",500)}}]),app.controller("dashboardController",["$routeParams","$scope","$rootScope","$location","locationMapService","assetManagementService","$timeout","$interval","$route",function(a,b,c,d,e,f,g,h,i){void 0==c.access_token?d.path("/login"):(b.notificationDashboard=!1,b.analyticsDashboard=!1,b.assetManagment=!0,b.assetDetailDashboard=!1,"notification"==a.dashboardSelect?(b.notificationDashboard=!0,b.analyticsDashboard=!1,b.assetManagment=!1,b.assetDetailDashboard=!1):"assetsearch"==a.dashboardSelect?(b.notificationDashboard=!1,b.analyticsDashboard=!1,b.assetManagment=!0,b.assetDetailDashboard=!1):"assetdetail"==a.dashboardSelect?(b.notificationDashboard=!1,b.analyticsDashboard=!1,b.assetManagment=!1,b.assetDetailDashboard=!0):(b.notificationDashboard=!1,b.analyticsDashboard=!0,b.assetManagment=!1,b.assetDetailDashboard=!1),b.assetDetail=function(a){c.assetUri=a,location.replace("/#/dashboard/assetdetail")},b.goBack=function(){location.replace("/#/dashboard/assetsearch")},c.querySearch=function(a){var d,e=a?c.productListDropDown.filter(b.createFilterFor(a)):c.productListDropDown;return c.simulateQuery?(d=$q.defer(),g(function(){d.resolve(e)},1e3*Math.random(),!1),d.promise):e},c.selectedItemChange=function(a){c.assetFilter=a?{product:a.display}:{},angular.element(".md-scroll-mask").remove(),angular.element("body").attr("style",""),location.replace("/#/dashboard/assetsearch")},b.loadAll=function(){if(angular.forEach(c.assetsList,function(a){c.productList&&a.serialNumber?c.productList+=", "+a.serialNumber:a.serialNumber&&(c.productList=a.serialNumber)}),c.productList)return c.productList.split(/, +/g).map(function(a){return{value:a.toLowerCase(),display:a}})},b.createFilterFor=function(a){var b=angular.lowercase(a);return function(a){return 0===a.value.indexOf(b)}},b.getAssetsList=function(a){(!c.assetsList||c.assetsList.length<0)&&f.getAssetsList().then(function(a){c.assetsList=a,c.productListDropDown=b.loadAll()})},b.getAssetsList(),c.$on("refreshAssetSearch",function(a){console.log("redirection success"),f.getAssetsList().then(function(a){c.assetsList=a,c.productListDropDown=b.loadAll()}),i.reload()}))}]),app.controller("loginController",["$scope","$location","$rootScope","loginService","$http",function(a,b,c,d,e){a.errorMsg="",a.errorFlag=!1,a.redirectToDashboard=function(){""==a.userDetails.username&&""==a.userDetails.password?(a.errorMsg="Please enter username & password",a.errorFlag=!0):(a.errorFlag=!1,a.userDetails={username:a.userDetails.username,password:a.userDetails.password},d.userLogin(a.userDetails).then(function(d){""!=d.access_token&&null!=d.access_token&&"null"!=d.access_token?(c.token_type=d.token_type,c.access_token=d.access_token,e.defaults.headers.common.Authorization="Bearer "+c.access_token,b.path("/dashboard/analytics")):(a.errorMsg=d.status.message,a.errorFlag=!0)}))}}]),app.controller("sidebarController",["$routeParams","$scope","$rootScope",function(a,b,c){b.sideBarExpanded=!1}]),app.controller("notificationDashboardController",["$routeParams","$scope","$rootScope","locationMapService","getDataService","notificationDashboardService","$interval","$location",function(a,b,c,d,e,f,g,h){void 0==c.access_token?h.path("/login"):(c.activePage="notification",f.getNotificationData().then(function(a){b.notificationData=a.data.notificationData}),g(function(){f.getNotificationData().then(function(a){b.notificationData=a.data.notificationData})},15e12),b.orderByDate=function(a){var b=a.dateStamp.split("/");return-parseInt(b[2]+b[1]+b[0])},b.orderByTime=function(a){var b,c=a.messageTime.split(":"),d=c[1].split(" ");return b="AM"==d[1]?1e5:2e5,-(b=b+parseInt(c[0])+parseInt(d[0]))},b.notificationFilterList={FAILURE:!1,PREDICTING_FAILURE:!1,UNDERGOING_MAINTENANCE:!1,NO_DATA:!1},b.all=function(){b.notificationFilterList.FAILURE=!1,b.notificationFilterList.PREDICTING_FAILURE=!1,b.notificationFilterList.UNDERGOING_MAINTENANCE=!1,b.notificationFilterList.NO_DATA=!1},b.failure=function(){b.notificationFilterList.FAILURE=!b.notificationFilterList.FAILURE},b.failurePred=function(){b.notificationFilterList.PREDICTING_FAILURE=!b.notificationFilterList.PREDICTING_FAILURE},b.UnderMaintainance=function(){b.notificationFilterList.UNDERGOING_MAINTENANCE=!b.notificationFilterList.UNDERGOING_MAINTENANCE},b.noData=function(){b.notificationFilterList.NO_DATA=!b.notificationFilterList.NO_DATA})}]),app.filter("notificationFilter",function(){return function(a,b){var c={filterCheck:b,out:[]};return(b.FAILURE||b.PREDICTING_FAILURE||b.NO_DATA||b.UNDERGOING_MAINTENANCE)===!1?c.out=a:angular.forEach(a,function(a,b){this.filterCheck[a.machineStatus]===!0&&this.out.push(a)},c),c.out}}),app.directive("analyticCard",function(){function a(a,b,c){}return{link:a,restrict:"E",scope:{data:"="}}});var arc=d3.svg.arc();app.directive("metricChart",["$window",function(a){function b(b,c,d){document.getElementById("metricChart")&&(b.width=document.getElementById("metricChart").clientWidth),b.width>0&&draw(b,c,d),angular.element(a).bind("resize",function(){d3.select("#metricChart").select("svg").remove(),document.getElementById("metricChart")&&(b.width=document.getElementById("metricChart").clientWidth),b.width>0&&draw(b,c,d),b.$digest()})}return{link:b,restrict:"E",scope:{data:"="}}}]);var arc=d3.svg.arc();app.directive("pumpEfficiencyDirective",["$window",function(a){function b(b,c,d){var e=0;if(c[0]&&(e=c[0].clientWidth),e>0){radialProgress(c[0]).diameter(e).value(d.pumpefficiencyval).render()}angular.element(a).bind("resize",function(){c[0]&&(c[0].innerHTML="");var a=0;if(c[0]&&(a=c[0].clientWidth),a>0){radialProgress(c[0]).diameter(a).value(d.pumpefficiencyval).render()}})}return{link:b,restrict:"A"}}]),app.directive("selectPump",function(a){function b(b,c,d){function e(){o.width(l.outerWidth()),o.height(l.outerHeight())}function f(){m.children().filter(".preselected").removeClass("preselected"),m.find("div").eq(p).addClass("preselected")}function g(){p=(p+1)%b.ops.length,f()}function h(){p=(p-1)%b.ops.length,f()}function i(){b.selectOpt(b.ops[p]),b.$apply()}for(var j in b.ops)b.ops[j].value==b.selection&&(b.selectedOpt=b.ops[j]);var k=!1;/ipad|iphone|android/gi.test(a.navigator.userAgent)&&(k=!0),b.selectOpt=function(a){b.selection=a.value,m.removeClass("active"),n.removeClass("active")},b.$watch("selection",function(a){for(var c in b.ops)b.ops[c].value==a&&(b.selectedOpt=b.ops[c])});var l=c.find(".my-select-label"),m=c.find(".my-select-ops"),n=c.find(".my-select-backdrop"),o=c.find("select");l.on("click",function(){e(),m.toggleClass("active"),n.toggleClass("active")}),n.on("click",function(){m.removeClass("active"),n.removeClass("active")}),c.on("keydown",function(a){switch(a.which){case 37:case 38:h();break;case 39:case 40:g();break;case 13:i()}}),e(),$(a).on("resize",function(){e()}),k&&o.addClass("active");var p=0;f()}return{link:b,scope:{ops:"=selectPump",selection:"=selection"},template:'<div class="my-select-label" tabindex="0" title="{{selectedOpt.label}}"><div class="my-select-label-text">{{selectedOpt.label}}</div><span class="my-select-caret"><svg viewBox="0 0 100 60"><polyline points="10,10 50,50 90,10" style="fill:none;stroke:#f3f3f3;stroke-width:8;stroke-linecap:round;"/></svg></span></div><div class="my-select-backdrop"></div><div class="my-select-ops"><div ng-repeat="o in ops" ng-click="selectOpt(o)">{{o.label}}</div></div><select ng-options="opt.value as opt.label for opt in ops" ng-model="selection"></select>'}}),app.service("analyticsMapService",function(a,b,c,d){function e(){c.showSpinner=!0;c.token_type,c.access_token;return a({method:"GET",header:{"Content-Type":"application/json"},
url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getAssetType"}).then(j,i)}function f(){c.showSpinner=!0;var b=c.token_type+" "+c.access_token;return a({method:"GET",header:{Authorization:b,"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getAssetData/machine"}).then(j,i)}function g(b){if(void 0!=b&&"undefined"!=b){c.showSpinner=!0;var d=c.token_type+" "+c.access_token;return a({method:"GET",header:{Authorization:d,"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getOverallEfficiency/"+b}).then(j,i)}}function h(b){if(void 0!=b&&"undefined"!=b){c.showSpinner=!0;var d=c.token_type+" "+c.access_token;return a({method:"GET",header:{Authorization:d,"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getPerformanceMetric/"+b}).then(j,i)}}function i(a){c.showSpinner=!1;var d="";return angular.isObject(a.data)&&a.data.message||(d=b.reject("An unknown error occurred.")),0===d.length&&(d=b.reject(a.data.message)),d}function j(a){return c.showSpinner=!1,a.data}return{getPumpTypeData:e,getMapLocationData:f,getOverallEffData:g,getPerformanceData:h}}),app.service("assetManagementService",function(a,b,c,d){function e(){c.showSpinner=!0;c.token_type,c.access_token;return a({method:"GET",header:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getEnergyConsumptionGraph/machine/1"}).then(t,s)}function f(){c.showSpinner=!0;c.token_type,c.access_token;return a({method:"GET",header:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getTimeseriesGraph/machine/1/tsIdentifier_vibration"}).then(t,s)}function g(){c.showSpinner=!0;c.token_type,c.access_token;return a({method:"GET",header:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getTimeseriesGraph/machine/1/tsIdentifier_daystofailure"}).then(t,s)}function h(){c.showSpinner=!0;c.token_type,c.access_token;return a({method:"GET",header:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getEnergyConsumptionGraph/machine/1"}).then(t,s)}function i(){c.showSpinner=!0;var b=c.token_type+" "+c.access_token;return a({method:"GET",header:{Authorization:b,"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/analytics/train/machine/1?timeDuration=1"}).then(t,s)}function j(b){c.showSpinner=!0;var d=c.token_type+" "+c.access_token;return a({method:"POST",data:b,header:{Authorization:d,"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/analytics"}).then(t,s)}function k(b){if(void 0!=b&&"undefined"!=b){c.showSpinner=!0;var d=c.token_type+" "+c.access_token;return a({method:"GET",header:{Authorization:d,"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/predictedCavitationFailure"+b}).then(t,s)}}function l(){c.showSpinner=!0;var b=c.token_type+" "+c.access_token;return a({method:"GET",header:{Authorization:b,"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getDischargePressureGraph/machine/1"}).then(t,s)}function m(){c.showSpinner=!0;c.token_type,c.access_token;return a({method:"GET",header:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getEnergyConsumptionGraph/machine/1"}).then(t,s)}function n(){c.showSpinner=!0;c.token_type,c.access_token;return a({method:"GET",header:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getDischargePressureGraph/machine/3"}).then(t,s)}function o(){c.showSpinner=!0;c.token_type,c.access_token;return a({method:"GET",header:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getEnergyConsumptionGraph/machine/3"}).then(t,s)}function p(){c.showSpinner=!0;c.token_type,c.access_token;return a({method:"GET",header:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getAssetData/machine"}).then(t,s)}function q(b){if(void 0!=b&&"undefined"!=b){c.showSpinner=!0;c.token_type,c.access_token;return a({method:"GET",header:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getAssetDataByAssetId"+b}).then(t,s)}}function r(b){c.showSpinner=!0;c.token_type,c.access_token;return a({method:"POST",header:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},data:b,url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/addUpdateAssetData/machine"}).then(t,s)}function s(a){c.showSpinner=!1;var d="";return angular.isObject(a.data)&&a.data.message||(d=b.reject("An unknown error occurred.")),0===d.length&&(d=b.reject(a.data.message)),d}function t(a){return c.showSpinner=!1,a.data}return{getPredixDischargeGraphData:l,getPredixEnergyGraphData:m,getStoredDischargeGraphData:n,getStoredEnergyGraphData:o,getPredixVibrationGraphData:e,getPredixDaysToFailureGraphData:f,getStoredVibrationGraphData:g,getStoredDaysToFailureGraphData:h,getAssetInfoData:q,getAssetsList:p,getAnalyticsData:j,getCavitationData:k,updateAssetInfoData:r,executeTraining:i}}),app.service("getDataService",function(a,b,c){function d(b){return c.showSpinner=!0,a({method:"get",url:b}).then(g,f)}function e(a){c.showSpinner=!0}function f(a){c.showSpinner=!1;var d="";return angular.isObject(a.data)&&a.data.message||(d=b.reject("An unknown error occurred.")),0===d.length&&(d=b.reject(a.data.message)),d}function g(a){return c.showSpinner=!1,a.data}return{getGetData:d,getPostData:e}}),app.service("loginService",function(a,b,c){function d(b){return c.showSpinner=!0,a({method:"POST",url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/login",data:{userDetails:b}}).then(f,e)}function e(a){var c="";return angular.isObject(a.data)&&a.data.message||(c=b.reject("An unknown error occurred.")),0==c.length&&(c=b.reject(a.data.message)),c}function f(a){return c.showSpinner=!1,a.data}return{userLogin:d}}),app.service("locationMapService",function(a,b,c,d){function e(a){return j=f(a)}function f(a){return j=new google.maps.Map(document.getElementById("outdoorMap"),{scrollwheel:!1,center:{lat:46.759197,lng:17.701408},zoom:3,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:[{elementType:"geometry",stylers:[{color:"#4e575f"}]},{elementType:"labels.text.stroke",stylers:[{color:"#000"}]},{elementType:"labels.text.fill",stylers:[{color:"#000"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"transparent"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"transparent"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#434b52"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#434b52"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#434b52"}]}]})}function g(a,b){var c,d,e;j.getCenter();h(null);var f={filter:b,out:[]};(b.FAILURE||b.PREDICTING_FAILURE||b.UNDERGOING_MAINTENANCE||b.NO_DATA||b.PERFORMING_OPTIMALLY)===!1?f.out=a:angular.forEach(a,function(a,b){this.filter[a.analyticAttributes.machineStatus]===!0&&this.out.push(a)},f),e=f.out,angular.forEach(e,function(a,b){function e(a,b){var c,d=f(a.getCenter()),e=f(b.getPosition()),g="";return g+=e.y>d.y?"b":"t",g+=e.x<d.x?"l":"r","tr"==g?c=new google.maps.Size(-70,315):"tl"==g?c=new google.maps.Size(100,315):"br"==g?c=new google.maps.Size(-70,20):"bl"==g&&(c=new google.maps.Size(70,20)),c}function f(a){return j.getProjection().fromLatLngToPoint(a)}d="FAILURE"==a.analyticAttributes.machineStatus?new google.maps.MarkerImage("../../assets/images/redMapDot.png",null,null,null,new google.maps.Size(35,35)):"PREDICTING_FAILURE"==a.analyticAttributes.machineStatus?new google.maps.MarkerImage("../../assets/images/yellowMapDot.png",null,null,null,new google.maps.Size(35,35)):"UNDERGOING_MAINTENANCE"==a.analyticAttributes.machineStatus?new google.maps.MarkerImage("../../assets/images/blueMapDot.png",null,null,null,new google.maps.Size(35,35)):"NO_DATA"==a.analyticAttributes.machineStatus?new google.maps.MarkerImage("../../assets/images/orangeMapDot.png",null,null,null,new google.maps.Size(35,35)):"PERFORMING_OPTIMALLY"==a.analyticAttributes.machineStatus?new google.maps.MarkerImage("../../assets/images/greenMapDot.png",null,null,null,new google.maps.Size(35,35)):new google.maps.MarkerImage("../../assets/images/dashboard.png",null,null,null,new google.maps.Size(35,35)),c=new google.maps.Marker({position:new google.maps.LatLng(a.latitude,a.longitude),map:j,icon:d}),k.push(c);var g="<div class='contentWindow col-xs-12 row'><h2>"+a.manufacturer+"</h2><div class='col-xs-12 '><div class='machineModelTitle titleSec col-xs-12'>Machine Model</div><div class='machineModelBody infSec col-xs-12'> "+a.modelName+"</div></div><div class='col-xs-12'><div class='avgPowerConTitle titleSec col-xs-12'>Average Power Consumption</div><div class='avgPowerConBody infSec col-xs-12'> "+a.analyticAttributes.averagePowerConsumption+"</div></div><div class='col-xs-12'><div class='effLevelTitle titleSec col-xs-12'>Efficiency Level</div><div class='effLevelBody infSec col-xs-12'>"+a.analyticAttributes.machineEfficiencyLevel+"</div></div></div>",h=new google.maps.InfoWindow({disableAutoPan:!0});google.maps.event.addListener(c,"click",function(a,b,c){return function(){c.setOptions({pixelOffset:e(j,a)}),c.setContent(b),c.open(j,a)}}(c,g,h)),c.addListener("mouseout",function(){h.close()}),google.maps.event.addListener(h,"domready",function(){var a=$(".gm-style-iw");a.css("margin-top","10px"),$(".contentWindow").parent().css("overflow","hidden");var b=a.prev();b.children(":nth-child(2)").css({display:"none"}),b.children(":nth-child(4)").css({display:"none"}),b.children(":nth-child(1)").attr("style",function(a,b){return b+"left: 76px !important;"}),b.children(":nth-child(1)").css("display","none"),b.children(":nth-child(3)").attr("style",function(a,b){return b+"left: 76px !important;"}),b.children(":nth-child(3)").css("display","none"),b.children(":nth-child(3)").find("div").children().css({"box-shadow":"rgba(72, 181, 233, 0.6) 0px 1px 6px","z-index":"1"});var c=a.next();c.css({opacity:"0",right:"38px",top:"3px","border-radius":"13px"}),$(".iw-content").height()<140&&$(".iw-bottom-gradient").css({display:"none"}),c.mouseout(function(){$(this).css({opacity:"1"})})}),google.maps.event.addListener(j,"click",function(){h.close()})})}function h(a){for(var b=0;b<k.length;b++)k[b].setMap(a)}function i(a){var b,c;c="MAINTENANCE"==a.status?new google.maps.MarkerImage("../../assets/images/blueMapDot.png",null,null,null,new google.maps.Size(35,35)):"FAILURE"==a.status?new google.maps.MarkerImage("../../assets/images/redMapDot.png",null,null,null,new google.maps.Size(35,35)):"PREDICTING_FAILURE"==a.status?new google.maps.MarkerImage("../../assets/images/yellowMapDot.png",null,null,null,new google.maps.Size(35,35)):"NO_DATA"==a.status?new google.maps.MarkerImage("../../assets/images/orangeMapDot.png",null,null,null,new google.maps.Size(35,35)):new google.maps.MarkerImage("../../assets/images/greenMapDot.png",null,null,null,new google.maps.Size(35,35)),b=new google.maps.Marker({position:new google.maps.LatLng(a.lat,a.lon),map:j,icon:c}),j.setCenter(new google.maps.LatLng(a.lat,a.lon)),j.setZoom(6),k.push(b)}var j,k=[];return{createOutdoorMap:e,createMachineMarkers:g,createAssetMachineMarkers:i}}),app.service("notificationDashboardService",function(a,b,c,d){function e(){c.showSpinner=!0;c.token_type,c.access_token;return a({method:"GET",header:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,HEAD,OPTIONS,POST,PUT","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept, Authorization","Content-Type":"application/json;charset:UTF-8"},url:"https://timeseries-test1.run.aws-usw02-pr.ice.predix.io/getNotificationsByCriteria"}).then(g,f)}function f(a){c.showSpinner=!1;var d="";return angular.isObject(a.data)&&a.data.message||(d=b.reject("An unknown error occurred.")),0===d.length&&(d=b.reject(a.data.message)),d}function g(a){return c.showSpinner=!1,a.data}return{getNotificationData:e}});